settings:
  kubeContext: "${CONTEXT}"
  reverseDelete: true

namespaces:
  staging:
  monitoring:
  default:

apps:

  cert-manager:
    timeout: 1200
    name: "cert-manager"
    description: "Certifacte Manager, able to create valid certificates on-demand"
    namespace: "default"
    enabled: true
    group: "critical"
    chart: "../@infra_cert-manager/cert-manager"
    version: "0.1.0"
    valuesFile: "../@infra_cert-manager/cert-manager/values.yaml"
    protected: true
    wait: true
    priority: -5
    setString:
      _global.namespace: "monitoring"
      "cert-manager.installCRDs": true

  ingress-monitoring:
    timeout: 1200
    name: "ingress"
    description: "Ingress, managing all incoming traffic and properly redirecting on services"
    namespace: "monitoring"
    enabled: true
    group: "critical"
    chart: "../@infra_ingress/ingress"
    version: "0.1.0"
    valuesFile: "../@infra_ingress/ingress/values.yaml"
    protected: false
    wait: true
    priority: 0
    setString:
      _global.namespace: "monitoring"

      issuer.server: "${CONFIG_STAGING_ACME_SERVER}"

      baseDomain: "ticket721.com"
      domainExtension: "monitoring"

      hosts[0].name: "api.staging.ticket721.com"
      hosts[0].paths[0].route: "/"
      hosts[0].paths[0].serviceName: "platform--server--svc"
      hosts[0].paths[0].servicePort: "80"

      route53.keyId: "${CONFIG_STAGING_ROUTE53_KEY}"
      route53.keySecret: "${CONFIG_STAGING_ROUTE53_SECRET}"
      route53.hostedzone: "${CONFIG_STAGING_ROUTE53_HOSTEDZONE}"
      route53.region: "eu-west-3"

  ingress-staging:
    timeout: 1200
    name: "ingress"
    description: "Ingress, managing all incoming traffic and properly redirecting on services"
    namespace: "staging"
    enabled: true
    group: "critical"
    chart: "../@infra_ingress/ingress"
    version: "0.1.0"
    valuesFile: "../@infra_ingress/ingress/values.yaml"
    protected: false
    wait: true
    priority: -1
    setString:
      _global.namespace: "staging"

      issuer.server: "${CONFIG_STAGING_ACME_SERVER}"

      baseDomain: "ticket721.com"
      domainExtension: "staging"

      hosts[0].name: "api.staging.ticket721.com"
      hosts[0].paths[0].route: "/"
      hosts[0].paths[0].serviceName: "platform--server--svc"
      hosts[0].paths[0].servicePort: "80"

      route53.keyId: "${CONFIG_STAGING_ROUTE53_KEY}"
      route53.keySecret: "${CONFIG_STAGING_ROUTE53_SECRET}"
      route53.hostedzone: "${CONFIG_STAGING_ROUTE53_HOSTEDZONE}"
      route53.region: "eu-west-3"

